这个文件用于记录需求讨论过程，格式：
### {标题为用户提的问题概要}
针对用户问题的回复概要，不超过200字
---

### 第1期需求讨论：多轮对话Agent（第1轮）

**用户目标**：搭建可逐步扩展的多agent项目，第1期实现支持多轮对话的agent，包含对话页面、新建对话、历史对话管理、继续对话等功能。

**讨论过程**：
1. AI服务商选择：OpenRouter，支持模型切换
2. 数据存储：Turso Cloud存储历史对话记录
3. 页面布局：左侧历史列表+右侧对话区
4. 用户认证：不需要，采用匿名ID方案区分用户
5. 对话管理：支持删除、重命名
6. 消息渲染：支持Markdown+代码高亮
7. 流式输出：需要（SSE）
8. 模型选择：对话区选择器
9. 功能点拆分：按模块/功能拆分，共23个功能点

**产出**：需求文档初稿完成，包含5大模块共23个功能点。

---

### 第1期需求讨论：多轮对话Agent（第2轮-优化）

**用户反馈**：
1. AI Elements组件利用率不足，应使用现有复合组件而非重新造轮子
2. API响应格式陈旧，应使用 `toUIMessageStreamResponse()`
3. 缺少开发者工具集成

**优化调整**：
1. 新增功能点3：AI SDK DevTools集成
2. 更新功能点7：API使用 `toUIMessageStreamResponse({ sendSources: true, sendReasoning: true })`
3. 更新模块四前端组件：
   - 功能点15：使用 `Conversation` 系列组件
   - 功能点16：使用 `Message` + `MessageResponse` 组件
   - 功能点17：使用 `PromptInput` 系列组件
   - 功能点18：使用 `ModelSelector` 系列组件
4. 组件目录统一调整为 `components/chat/`

**产出**：需求文档v2完成，保持23个功能点，充分复用AI Elements组件，减少开发工作量。

---

### 第1期需求讨论：多轮对话Agent（第3轮-附件组件细化）

**用户反馈**：附件显示组件需要更具体化，建议在输入框头部集成 `PromptInputAttachmentsDisplay`。

**优化调整**：
- 更新功能点17，详细说明 `Attachments` 系列组件的使用：
  - `Attachments` 容器支持三种变体：`grid` / `inline` / `list`
  - `Attachment` 单项组件
  - `AttachmentPreview` 预览组件（图片/视频/图标）
  - `AttachmentInfo` 文件名显示
  - `AttachmentRemove` 删除按钮
  - `PromptInputActionAddAttachments` 上传触发器
- 附件预览显示在输入框头部（使用 `PromptInputHeader`）

**产出**：需求文档v3完成，附件功能描述更加具体。

---
